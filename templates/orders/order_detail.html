{% extends 'base.html' %}

{% block title %}Order #{{ order.id }} - Nexara{% endblock %}

{% block content %}
<div class="container" style="margin-top: 20px;">
    <div style="background: white; padding: 20px; box-shadow: var(--shadow); margin-bottom: 20px;">
        <h2 style="font-size: 18px; font-weight: 600;">Order Details</h2>
        <hr style="margin: 15px 0; border: 0.5px solid #f0f0f0;">
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 40px;">
            <div>
                <h3 style="font-size: 14px; color: #878787; text-transform: uppercase; margin-bottom: 10px;">Delivery Address</h3>
                <p style="font-weight: 600; margin-bottom: 5px;">{{ order.first_name }} {{ order.last_name }}</p>
                <p style="font-size: 14px; line-height: 1.6;">{{ order.address }}<br>{{ order.city }}, {{ order.state }} - {{ order.pincode }}</p>
                <p style="font-size: 14px; margin-top: 10px;"><strong>Phone:</strong> {{ order.user.profile.phone }}</p>
            </div>
            
            <div>
                <h3 style="font-size: 14px; color: #878787; text-transform: uppercase; margin-bottom: 10px;">Order Summary</h3>
                <div style="font-size: 14px;">
                    <p style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>Status:</span> <span style="font-weight: 600; color: #388e3c;">{{ order.status }}</span></p>
                    <p style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>Items Total:</span> <span>₹{{ order.total_price }}</span></p>
                    <p style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>Delivery:</span> <span style="color: green;">FREE</span></p>
                    <hr style="margin: 10px 0; border: 0.5px dashed #e0e0e0;">
                    <p style="display: flex; justify-content: space-between; font-weight: 700; font-size: 16px;"><span>Total:</span> <span>₹{{ order.total_price }}</span></p>
                </div>
            </div>
            
            <div style="text-align: right; display: flex; flex-direction: column; gap: 10px; align-items: flex-end;">
                {% if order.status != 'Cancelled' %}
                    <a href="{% url 'generate_invoice' order.id %}" target="_blank" class="btn-primary" style="width: auto; padding: 8px 25px; background: #fff; color: #2874f0; border: 1px solid #e0e0e0; font-size: 12px; text-decoration: none;"><i class="fas fa-file-invoice"></i> INVOICE</a>
                    <a href="{% url 'cancel_order' order.id %}" onclick="return confirm('Are you sure you want to cancel this order?')" style="width: auto; padding: 8px 25px; background: #fff; color: #ff4343; border: 1px solid #e0e0e0; font-size: 12px; text-decoration: none; font-weight: 600;">CANCEL ORDER</a>
                {% endif %}
            </div>
        </div>
    </div>

    <div style="background: white; padding: 0; box-shadow: var(--shadow);">
        {% for item in order.items.all %}
        <div style="display: flex; gap: 20px; padding: 20px; border-bottom: 1px solid #f0f0f0;">
            <img src="{{ item.product.get_image }}" alt="{{ item.product.name }}" style="width: 80px; height: 80px; object-fit: contain;">
            <div style="flex: 1;">
                <p style="font-size: 16px; font-weight: 500;">{{ item.product.name }}</p>
                <p style="font-size: 14px; color: #878787;">Qty: {{ item.quantity }}</p>
                <p style="font-weight: 700; margin-top: 10px;">₹{{ item.price }}</p>
            </div>
            <div style="width: 250px;">
                <p style="font-weight: 600; font-size: 14px;"><i class="fas fa-circle" style="color: #388e3c; font-size: 8px; vertical-align: middle; margin-right: 5px;"></i> Delivered on {{ order.created_at|date:"M d" }}</p>
                <p style="font-size: 12px; color: #878787; margin-top: 5px;">Your item has been delivered</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
