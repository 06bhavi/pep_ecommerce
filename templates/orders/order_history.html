{% extends 'base.html' %}

{% block title %}My Orders - Nexara{% endblock %}

{% block content %}
<div class="container" style="margin-top: 20px;">
    <div style="display: flex; gap: 20px;">
        <!-- Sidebar same as profile -->
        <aside style="width: 280px;">
            <div style="background: white; box-shadow: var(--shadow);">
                <a href="{% url 'order_history' %}" style="display: block; padding: 15px 20px; text-decoration: none; color: #2874f0; border-bottom: 1px solid #f0f0f0; font-weight: 600; background: #f0f7ff;"><i class="fas fa-box" style="margin-right: 15px;"></i> MY ORDERS <i class="fas fa-chevron-right" style="float: right;"></i></a>
                
                <div style="padding: 15px 20px; border-bottom: 1px solid #f0f0f0;">
                    <p style="font-weight: 600; color: #878787; margin-bottom: 10px;"><i class="fas fa-user" style="color: #2874f0; margin-right: 15px;"></i> ACCOUNT SETTINGS</p>
                    <ul style="list-style: none; margin-left: 30px;">
                        <li style="margin-bottom: 10px;"><a href="{% url 'profile' %}" style="text-decoration: none; color: black;">Profile Information</a></li>
                        <li style="margin-bottom: 10px;"><a href="{% url 'profile_update' %}" style="text-decoration: none; color: black;">Update Profile</a></li>
                    </ul>
                </div>
                
                <a href="{% url 'wishlist_detail' %}" style="display: block; padding: 15px 20px; text-decoration: none; color: #878787; border-bottom: 1px solid #f0f0f0; font-weight: 600;"><i class="fas fa-heart" style="color: #2874f0; margin-right: 15px;"></i> MY WISHLIST <i class="fas fa-chevron-right" style="float: right;"></i></a>
            </div>
        </aside>

        <!-- Orders List -->
        <div style="flex: 1;">
            {% for order in orders %}
            <div style="background: white; padding: 20px; box-shadow: var(--shadow); margin-bottom: 20px; border: 1px solid #f0f0f0; border-radius: 4px;">
                <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #f0f0f0; padding-bottom: 15px; margin-bottom: 15px;">
                    <div>
                        <p style="font-weight: 600; font-size: 14px;">Order #{{ order.id }}</p>
                        <p style="font-size: 12px; color: #878787;">Placed on {{ order.created_at|date:"D, d M Y" }}</p>
                    </div>
                    <div style="text-align: right;">
                        <p style="font-weight: 700; color: {% if order.status == 'Cancelled' %}#ff4343{% else %}#2874f0{% endif %};">
                            {% if order.status == 'Completed' %}
                                <i class="fas fa-circle" style="font-size: 8px; vertical-align: middle;"></i> Delivered
                            {% elif order.status == 'Cancelled' %}
                                <i class="fas fa-times-circle"></i> Cancelled
                            {% else %}
                                {{ order.status }}
                            {% endif %}
                        </p>
                        <a href="{% url 'order_detail' order.id %}" style="font-size: 12px; color: #2874f0; text-decoration: none; font-weight: 600;">View Details</a>
                    </div>
                </div>
                
                {% for item in order.items.all %}
                <div style="display: flex; gap: 20px; margin-bottom: 15px;">
                    <img src="{{ item.product.get_image }}" alt="{{ item.product.name }}" style="width: 70px; height: 70px; object-fit: contain;">
                    <div style="flex: 1;">
                        <p style="font-size: 14px; font-weight: 500;">{{ item.product.name }}</p>
                        <p style="font-size: 12px; color: #878787;">Qty: {{ item.quantity }}</p>
                        <p style="font-weight: 600; margin-top: 5px;">₹{{ item.price }}</p>
                    </div>
                </div>
                {% endfor %}
                
                <div style="border-top: 1px solid #f0f0f0; padding-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; gap: 10px;">
                        {% if order.status != 'Cancelled' %}
                            <a href="{% url 'cancel_order' order.id %}" onclick="return confirm('Are you sure you want to cancel this order?')" style="padding: 5px 15px; border-radius: 2px; border: 1px solid #ddd; color: #ff4343; text-decoration: none; font-size: 12px; font-weight: 600;">CANCEL ORDER</a>
                            <a href="{% url 'generate_invoice' order.id %}" target="_blank" style="padding: 5px 15px; border-radius: 2px; border: 1px solid #ddd; color: #2874f0; text-decoration: none; font-size: 12px; font-weight: 600;">INVOICE</a>
                        {% endif %}
                    </div>
                    <p style="font-weight: 600;">Total Amount: <span style="font-size: 18px;">₹{{ order.total_price }}</span></p>
                </div>
            </div>
            {% empty %}
            <div style="background: white; padding: 50px; text-align: center; box-shadow: var(--shadow);">
                <i class="fas fa-shopping-bag" style="font-size: 50px; color: #e0e0e0;"></i>
                <h2 style="margin-top: 20px;">No orders found!</h2>
                <p style="color: #878787; margin-top: 10px;">Seems like you haven't ordered anything yet.</p>
                <a href="{% url 'home' %}" class="btn-primary" style="display: inline-block; width: auto; padding: 12px 60px; margin-top: 20px; text-decoration: none;">Shop Now</a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
